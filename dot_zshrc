# ZSH completions
fpath+=("$HOME/.local/share/zsh/site-functions")
autoload -U compinit; compinit
# compdef _chezmoi chezmoi
# compdef _chezmoi cz

# Set personal aliases
[ -f $HOME/.aliases ] && source $HOME/.aliases

# History
HISTFILE=~/.zsh_history # Location of the history file
HISTSIZE=10000         # Maximum number of commands in memory
SAVEHIST=10000         # Maximum number of commands to save to the history file
setopt appendhistory   # Append history to the file (instead of overwriting)
setopt sharehistory    # Share history across all open zsh sessions
setopt extendedhistory # Save timestamps and command durations to the history file

# Enable command history search with Up/Down arrows
# https://coderwall.com/p/jpj_6q/zsh-better-history-searching-with-arrow-keys
autoload -U up-line-or-beginning-search
autoload -U down-line-or-beginning-search
zle -N up-line-or-beginning-search
zle -N down-line-or-beginning-search
bindkey "^[[A" up-line-or-beginning-search # Up
bindkey "^[[B" down-line-or-beginning-search # Down

# Export Java and Android environments
export ANDROID_HOME=$HOME/android/sdk
# export JAVA_OPTS='-XX:+IgnoreUnrecognizedVMOptions --add-modules java.se.ee'

# export NVM_DIR="$HOME/.nvm"
# [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
# [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

## Add yarn global to PATH
# export PATH="$(yarn global bin):$PATH"

# Add Flutter to PATH
export PATH="$PATH:$HOME/flutter/bin"
export PATH="$PATH":"$HOME/flutter/.pub-cache/bin"

# Add local bin to PATH
export PATH="$PATH:$HOME/.local/bin"

# Add Go to path
export GOPATH=$HOME/go
export PATH="$PATH:/usr/local/go/bin"
export PATH="$PATH:$GOPATH/bin"

# Set default editor
export EDITOR=/bin/nano

# Add platform tools to path
export PATH="$PATH:$HOME/android/sdk/platform-tools"
# if [ /usr/bin/kubectl ]; then source <(kubectl completion zsh); fi

# Pyenv
export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
if command -v pyenv 1>/dev/null 2>&1; then
  eval "$(pyenv init -)"
fi

# Podman docker-compose rootless setup
# https://fedoramagazine.org/use-docker-compose-with-podman-to-orchestrate-containers-on-fedora/
export DOCKER_HOST=unix:///run/user/$UID/podman/podman.sock

# The next line updates PATH for the Google Cloud SDK.
if [ -f '$HOME/google-cloud-sdk/path.zsh.inc' ]; then . '$HOME/google-cloud-sdk/path.zsh.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '$HOME/google-cloud-sdk/completion.zsh.inc' ]; then . '$HOME/google-cloud-sdk/completion.zsh.inc'; fi

# Add flyio
export FLYCTL_INSTALL="$HOME/.fly"
export PATH="$FLYCTL_INSTALL/bin:$PATH"

# Disable auto-correction
unsetopt correct_all

# Starship
eval "$(starship init zsh)"
